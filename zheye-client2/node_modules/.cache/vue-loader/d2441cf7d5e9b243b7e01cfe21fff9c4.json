{"remainingRequest":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\src\\views\\Index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\src\\views\\Index.vue","mtime":1595577834000},{"path":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xyh\\Desktop\\进化星球知乎\\第十八周资料\\zheye-client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBGZWVkSXRlbSBmcm9tICJAL2NvbXBvbmVudHMvRmVlZEl0ZW0udnVlIjsKaW1wb3J0IEdsb2JhbFNpZGVCYXIgZnJvbSAiQC9jb21wb25lbnRzL0dsb2JhbFNpZGVCYXIudnVlIjsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgdXRpbCBmcm9tICJAL3V0aWxzL2luZGV4LmpzIjsKCmxldCBMb2FkOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBjb21wb25lbnRzOiB7CiAgICBGZWVkSXRlbSwKICAgIEdsb2JhbFNpZGVCYXIKICB9LAogIGNvbXB1dGVkOiB7CiAgICAvL+ebkeWQrOivjeadoQogICAgLi4ubWFwR2V0dGVycyhbImlzQWRkIiwgInNlYXJjaExpc3QiXSkKICB9LAogIHdhdGNoOiB7CiAgICBpc0FkZDogZnVuY3Rpb24obmV3VmFsdWUpIHsKICAgICAgdGhpcy5nZXRDb250ZW50KCk7CiAgICB9LAogICAgc2VhcmNoTGlzdDogZnVuY3Rpb24obmV3VmFsdWUpIHsKICAgICAgdGhpcy5mZWVkTGlzdCA9IG5ld1ZhbHVlOwogICAgICBjb25zb2xlLmxvZygi5pu05paw5YiX6KGoIik7CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmVlZExpc3Q6IFtdLAogICAgICBhY3RpdmVOYW1lOiAicmVjb21tZW5kIiwKICAgICAgZm9sbG93TGlzdDogW10sCiAgICAgIGlzTG9hZDogZmFsc2UsCiAgICAgIHJlY1BhZ2U6IDEsIC8v5o6o6I2Q6aG16Z2icGFnZQogICAgICBhdHRQYWdlOiAxLCAvL+WFs+azqOmhtemdonBhZ2UKICAgICAgaXNFbmQ6ZmFsc2UsCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0Q29udGVudCgpOwogICAgdGhpcy5saXN0ZW5TY3JvbGwoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8v5o6o6I2Q6aG16Z2i6I635Y+W5pWw5o2uCiAgICBnZXRDb250ZW50KCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic2VhcmNoIiwgIiIpOwogICAgICB0aGlzLmF4aW9zLmdldChgL2luZGV4P3BhZ2U9JHt0aGlzLnJlY1BhZ2V9YCkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgdGhpcy5mZWVkTGlzdCA9IHRoaXMuZmVlZExpc3QuY29uY2F0KHJlcy5kYXRhKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzZXRJc0FkZCIsIGZhbHNlKTsKICAgICAgICAgIHRoaXMuaXNMb2FkID0gZmFsc2U7CiAgICAgICAgICBpZighcmVzLmRhdGEpewogICAgICAgICAgICB0aGlzLmlzRW5kID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v5YWz5rOo6aG16Z2i6I635Y+W5pWw5o2uCiAgICBnZXRBdHRlbnRpb24oKSB7CiAgICAgIHRoaXMuYXhpb3MuZ2V0KGAvZm9sbG93TGlzdD9wYWdlPSR7dGhpcy5hdHRQYWdlfWApLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgIHRoaXMuZm9sbG93TGlzdCA9IHRoaXMuZm9sbG93TGlzdC5jb25jYXQocmVzLmRhdGEpOwogICAgICAgICAgIGlmIChMb2FkKSB7CiAgICAgICAgICAgIExvYWQuY2xvc2UoKTsKICAgICAgICAgICAgTG9hZD0iIjsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuaXNMb2FkID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvL+a7muWKqAogICAgbGlzdGVuU2Nyb2xsKGVsZSkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCBmdW5jdGlvbigpIHsKICAgICAgICBsZXQgc2NyID0gZWxlLnNjcm9sbFRvcDsgLy8g5ZCR5LiK5rua5Yqo55qE6YKj5LiA6YOo5YiG6auY5bqmCiAgICAgICAgbGV0IGNsaWVudEhlaWdodCA9IGVsZS5jbGllbnRIZWlnaHQ7IC8vIOWxj+W5lemrmOW6puS5n+WwseaYr+W9k+WJjeiuvuWkh+mdmeaAgeS4i+S9oOaJgOeci+WIsOeahOinhuiniemrmOW6pgogICAgICAgIGxldCBzY3JIZWlnaHQgPSBlbGUuc2Nyb2xsSGVpZ2h0OyAvLyDmlbTkuKrnvZHpobXnmoTlrp7pmYXpq5jluqbvvIzlhbzlrrlQY+errwogICAgICAgIGlmIChzY3IgKyBjbGllbnRIZWlnaHQgKyA1ID49IHNjckhlaWdodCkgewogICAgICAgICAgY29uc29sZS5sb2coIuWIsOW6leS6hiIpOwogICAgICAgICAgaWYgKHRoYXQuaXNMb2FkID09IGZhbHNlfHx0aGlzLmlzRW5kID09IGZhbHNlKSB7CiAgICAgICAgICAgIHRoYXQuaXNMb2FkID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHRoYXQuYWN0aXZlTmFtZSA9PSAicmVjb21tZW5kIikgewogICAgICAgICAgICAgIHRoYXQucmVjUGFnZSsrOwogICAgICAgICAgICAgIHRoYXQuZ2V0Q29udGVudCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoYXQuYXR0UGFnZSsrOwogICAgICAgICAgICAgIHRoYXQuZ2V0QXR0ZW50aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v5YiH5o2i6YCJ6aG55Y2hCiAgICBjaGFuZ2VJdGVtKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLmFjdGl2ZU5hbWUpOwogICAgICBpZiAodGhpcy5hY3RpdmVOYW1lID09ICJhdHRlbnRpb24iKSB7CiAgICAgICAgLy/osIPnlKjmjqXlj6MKICAgICAgICB0aGlzLmdldEF0dGVudGlvbigpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ2V0Q29udGVudCgpOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Index.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"Topstory-container\">\n    <div class=\"Topstory-mainColumn\">\n      <el-tabs v-model=\"activeName\" @tab-click=\"changeItem\">\n        <el-tab-pane label=\"推荐\" name=\"recommend\">\n          <div v-for=\"(item,index) in feedList\" :key=\"index\">\n            <feed-item :feedList=\"item\"></feed-item>\n          </div>\n        </el-tab-pane>\n        <el-tab-pane label=\"关注\" name=\"attention\">\n          <div v-for=\"(item,index) in followList\" :key=\"index\">\n            <feed-item :feedList=\"item\"></feed-item>\n          </div>\n        </el-tab-pane>\n      </el-tabs>\n      <div class=\"Loading\" v-show=\"isLoad\">拼命加载中</div>\n      <div class=\"Loading\" v-show=\"isEnd\">到底了</div>\n    </div>\n    <div class=\"GlobalSideBar\">\n      <global-side-bar></global-side-bar>\n    </div>\n  </div>\n</template>\n<script>\nimport FeedItem from \"@/components/FeedItem.vue\";\nimport GlobalSideBar from \"@/components/GlobalSideBar.vue\";\nimport { mapGetters } from \"vuex\";\nimport util from \"@/utils/index.js\";\n\nlet Load;\nexport default {\n  name: \"index\",\n  components: {\n    FeedItem,\n    GlobalSideBar\n  },\n  computed: {\n    //监听词条\n    ...mapGetters([\"isAdd\", \"searchList\"])\n  },\n  watch: {\n    isAdd: function(newValue) {\n      this.getContent();\n    },\n    searchList: function(newValue) {\n      this.feedList = newValue;\n      console.log(\"更新列表\");\n    }\n  },\n  data() {\n    return {\n      feedList: [],\n      activeName: \"recommend\",\n      followList: [],\n      isLoad: false,\n      recPage: 1, //推荐页面page\n      attPage: 1, //关注页面page\n      isEnd:false,\n    };\n  },\n  mounted() {\n    this.getContent();\n    this.listenScroll(document.documentElement);\n  },\n  methods: {\n    //推荐页面获取数据\n    getContent() {\n      this.$store.dispatch(\"search\", \"\");\n      this.axios.get(`/index?page=${this.recPage}`).then(res => {\n        if (res.status == 200) {\n          this.feedList = this.feedList.concat(res.data);\n          this.$store.dispatch(\"setIsAdd\", false);\n          this.isLoad = false;\n          if(!res.data){\n            this.isEnd = true;\n          }\n        }\n      });\n    },\n    //关注页面获取数据\n    getAttention() {\n      this.axios.get(`/followList?page=${this.attPage}`).then(res => {\n        if (res.status == 200) {\n          this.followList = this.followList.concat(res.data);\n           if (Load) {\n            Load.close();\n            Load=\"\";\n          }\n          this.isLoad = false;\n        }\n      });\n    },\n    //滚动\n    listenScroll(ele) {\n      let that = this;\n      window.addEventListener(\"scroll\", function() {\n        let scr = ele.scrollTop; // 向上滚动的那一部分高度\n        let clientHeight = ele.clientHeight; // 屏幕高度也就是当前设备静态下你所看到的视觉高度\n        let scrHeight = ele.scrollHeight; // 整个网页的实际高度，兼容Pc端\n        if (scr + clientHeight + 5 >= scrHeight) {\n          console.log(\"到底了\");\n          if (that.isLoad == false||this.isEnd == false) {\n            that.isLoad = true;\n            if (that.activeName == \"recommend\") {\n              that.recPage++;\n              that.getContent();\n            } else {\n              that.attPage++;\n              that.getAttention();\n            }\n          }\n        }\n      });\n    },\n    //切换选项卡\n    changeItem() {\n      console.log(this.activeName);\n      if (this.activeName == \"attention\") {\n        //调用接口\n        this.getAttention();\n      } else {\n        this.getContent();\n      }\n    }\n  }\n};\n</script>\n<style lang=\"scss\" >\n@import \"../assets/css/config\";\n.Topstory-container {\n  display: flex;\n  width: 1000px;\n  padding: 0 16px;\n  margin: 10px auto;\n  height: 100%;\n}\n.Topstory-mainColumn {\n  width: 654px;\n  height: 100%;\n  .el-tabs__header {\n    background: #ffffff;\n    padding: 10px 20px;\n    margin: 0;\n    border-bottom: 1px solid #ebebeb;\n  }\n  .el-tabs__item {\n    font-size: 16px;\n  }\n  .el-tabs__item.is-active {\n    color: $mainColor;\n  }\n  .el-tabs__nav-wrap::after {\n    background: transparent;\n  }\n  .el-tabs__active-bar {\n    height: 0;\n  }\n}\n.GlobalSideBar {\n  margin-left: 10px;\n  flex: 1;\n}\n.Loading {\n  height: 50px;\n  text-align: center;\n  color: $mainColor;\n\n}\n</style>"]}]}